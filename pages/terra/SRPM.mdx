---
name: SRPM Macros
description: Documentation on the macros included in the anda-srpm-macros package
---

We provide SPRM macros to ease packaging and better integrate into our workflow. Please use these macros when possible.

These are provided in the `anda-srpm-macros` package. If you use them, make sure to add `anda-srpm-macros` as a `BuildRequires:` in the spec file.

You may need to refer to the [miscellaneous packaging guidelines](./policy#miscellaneous-packaging-guidelines) for more details.

For other macros available in Fedora/Terra, check out our unofficial [macros list](../rpm/macros).

# Anda Directories

# Shell Completions

# Electron

## %electron_install
Install files built from an Electron project.

# Go

# JavaScript/JavaScript Package Managers

# Nim

# Rust

## %cargo_prep_online
Enables internet access for `cargo_prep`. Replaces `%cargo_prep` in `%prep`.

## %cargo_license_online
Enables internet access for `cargo_license`.
Replaces `%cargo_license` in `%build`.

## %cargo_license_summary_online
Enables internet access for `cargo_license_summary`.
Replaces `%cargo_license_summary` in `%build`.

## %cargo_vendor_manifest_online
Enables internet access for `cargo_vendor_manifest_online`. 
Replaces `%cargo_vendor_manifest` in `%build`. 

## %crate_install_bin
Used to install crates that build as single binary.
Can be used instead of `%cargo_install` when [this](https://github.com/terrapkg/packages/issues/1169) is applicable.

## %rustup_nightly
Used in `%prep` for nightly `rustc`/`cargo` from `rustup`.

# Subpackages (-devel)

# Zig

# Miscellaneous

## %git_clone
Downloads the source code via `git clone` with the `--depth=1`, `-q`, and `--recursive-submodules` flags. Should only be used when downloading a compressed source cannot be used (for example, if the build process expects a git environment or the release tarball doesn't contain submodules).

## %evr
used for declaring how a package interacts with others, for acampe, in a `Requires:` tag.
For example, `Requires: %{name} = %evr`
expands to `%{?epoch:%{epoch}:}%{version}-%{release}`.


| Macro                           | Function                                                               |
| ------------------------------- | ---------------------------------------------------------------------- |
| `%go_task`                      | go-task
| `%nim_prep`                     | Setting up `nimble`                                                    |
| `%nim_build` or `%nim_c`        | Builds a nim package. Requires an argument to `src/pkgname`            |
| `%nim_tflags`                   |                                                                        |
| `%nim_lflags`                   |                                                                        |
| `%pkg_completion`               | Check [here](https://developer.fyralabs.com/terra/policy#shell-completions) for more details |
| `%pkg_devel_files`              | Set the summary & description, then find development `%files`.         |
| `%pkg_static_files`             | Set the summary & description, then find static libraries.             |
| `%_anda_srpm_macros_dir`        | `/usr/libexec/anda-srpm-macros`                                        |
| `%__anda_develfiles`            |                                                                        |
| `%__anda_staticfiles`           |                                                                        |
| `%__anda_libsfiles`             |                                                                        |
| `%pkg_libs_files`               |                                                                        |
| `%files_libs`                   |                                                                        |
| `%rpmbuilddir`                  | `%{?builddir}%{?!builddir:%{_builddir}}`                               |
| `%elvish_completions_dir`       | `%_datadir/elvish/lib/completions`                                     |
| `%_sccache`                     | `/usr/bin/sccache`                                                     |
| `%sccache_prep`                 | Sets up environment variables for `sccache`                            |
| `%cargo_prep_online_sccache`    |                                                                        |
| `%bun_common_envvars`           |                                                                        |
| `%__bun`                        | `/usr/bin/env %{bun_common_envvars} /usr/bin/bun`                      |
| `%__bunx`                       |                                                                        |
| `%bun_build`                    | bun build                                                              |
| `%bun_audit`                    | bun audit, for use in the `%check` section                             |
| `%bun_pm_trust`                 |                                                                        |
| `%vendor_pnpm`                  | If PNPM is not usable/available from repo                              |
| `%pnpm_common_envvars`          |                                                                        |
| `%__pnpm`                       | `/usr/bin/env %{pnpm_common_envvars} %{?with_vendored_pnpm:%{rpmbuilddir}/pnpm/pnpm}%{!?with_vendored_pnpm:/usr/bin/pnpm}` |
| `%__pnpx`                       |                                                                        |
| `%pnpm_build`                   | pnpm build                                                             |
| `%pnpm_audit`                   | Audit pnpm if package uses bundled Node dependencies. For use in the `%check` section |
| `%pnpm_audit_fix`               | Fix dependencies using PNPM                                            |
| `%pnpm_approve_builds`          | Approve dependency scripts if needed                                   |
| `%yarn_common_envvars`          |                                                                        |
| `%__yarn`                       | `/usr/bin/env %{yarn_common_envvars} /usr/bin/yarn`                    |
| `%__yarn_dlx`                   |                                                                        |
| `%yarn_build`                   | yarn build                                                             |
| `%yarn_audit`                   | Audit yarn if package uses bundled Node dependencies. For use in the `%check` section |
| `electronmeta`                  |                                                                        |

| `%npm_common_envvars`           |                                                                        |
| `%npm_buildflags`               |                                                                        |
| `%set_node_build_flags`         |                                                                        |
| `%__npm`                        |                                                                        |
| `%__npx`                        |                                                                        |
| `%npm_build`                    | npm build                                                              |
| `%__nvm`                        |                                                                        |
| `%npm_prep`                     |                                                                        |
| `%fetch_node_tests`             |                                                                        |
| `%npm_install`                  |                                                                        |
| `%npm_audit`                    |                                                                        |
| `%npm_audit_fix`                |                                                                        |
| `%__npm_license_checker`        |                                                                        |
| `%npm_license_summary`          |                                                                        |
| `%npm_license`                  |                                                                        |
| `%node_self_test`               |                                                                        |
| `%npm_test`                     |                                                                        |
| `%zig_build_target`             | Check out our Zig packaging guidelines [here](https://developer.fyralabs.com/terra/policy#zig) |
